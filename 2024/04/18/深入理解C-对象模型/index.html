<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="xx">
    <meta name="author" content="hahahanba">
    
    <title>
        
            深入理解C++对象模型(一) |
        
        hahahanba&#39;s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
        <link rel="shortcut icon" href="https://cdn.staticaly.com/gh/hahahanba/hahahanba.github.io@main/images/star.5dh2c651m3k0.webp">
    
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.7.3/source/font/css/fontawesome.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.7.3/source/font/css/regular.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.7.3/source/font/css/solid.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.7.3/source/font/css/brands.min.css">
    
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"hahahanba.github.io","root":"/","language":"zh-CN","path":"search.xml"}
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":false,"init_open":true,"layout":"left"},"style":{"primary_color":"#0066cc","logo":"","favicon":"https://cdn.staticaly.com/gh/hahahanba/hahahanba.github.io@main/images/star.5dh2c651m3k0.webp","avatar":"https://i.imgur.com/9lnXdbm.png","first_screen":{"enable":true,"header_transparent":false,"background_img":"/images/bg.svg","description":"Keep writing and Keep loving.","hitokoto":true},"scroll":{"progress_bar":false,"percent":false}},"local_search":{"enable":true,"preload":true},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"default"},"side_tools":{},"pjax":{"enable":false},"lazyload":{"enable":true},"comment":{"enable":true,"use":"giscus","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.8"},"waline":{"server_url":null,"reaction":false,"version":2},"giscus":{"repo":"hahahanba/comments","repo_id":"R_kgDOKGpC9g","category":"Announcements","category_id":"DIC_kwDOKGpC9s4CYk-p","reactions_enabled":true}},"post":{"author_label":{"enable":true,"auto":true,"custom_label_list":["Trainee","Engineer","Architect","emmm..."]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"img_align":"left"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"version":"3.7.3"}
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"}
    KEEP.language_code_block = {"copy":"复制代码","copied":"已复制","fold":"折叠代码块","folded":"已折叠"}
    KEEP.language_copy_copyright = {"copy":"复制版权信息","copied":"已复制","title":"原文标题","author":"原文作者","link":"原文链接"}
  </script>
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="progress-bar-container">
    

    
</div>


<main class="page-container border-box">

    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="border-box header-content">
        <div class="left border-box">
            
            <a class="site-name border-box" href="/">
               hahahanba&#39;s Blog
            </a>
        </div>

        <div class="right border-box">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                标签
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                分类
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                友链
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                关于
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">标签</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">分类</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links">友链</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">关于</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">

                

                    <div class="fade-in-down-animation">
    <div class="post-page-container border-box">

        <div class="article-content-container border-box">

            <div class="article-title">
                <span class="title-hover-animation">深入理解C++对象模型(一)</span>
            </div>

            
                <div class="article-header border-box">
                    
                        <div class="avatar-box border-box">
                            <img src="https://i.imgur.com/9lnXdbm.png">
                        </div>
                    
                    <div class="info-box">
                        <div class="author">
                            <span class="name">hahahanba</span>
                            
                                <span class="author-label">Lv1</span>
                            
                        </div>
                        <div class="meta-info border-box">
                            

<div class="article-meta-info-container border-box post">
    <div class="article-meta-info border-box">
        


        
            <span class="meta-info-item article-create-date">
                <i class="icon fa-solid fa-calendar-check"></i>&nbsp;
                <span class="pc">2024-04-18 10:25:22</span>
                <span class="mobile">2024-04-18 10:25</span>
            </span>

            <span class="meta-info-item article-update-date">
                <i class="icon fa-solid fa-file-pen"></i>&nbsp;
                <span class="pc">2024-04-18 10:26:03</span>
            </span>
        

        
            <span class="meta-info-item article-category border-box"><i class="icon fas fa-folder"></i>&nbsp;
                <ul>
                    
                </ul>
            </span>
        

        
            <span class="article-tag meta-info-item border-box">
                <i class="icon fas fa-tags"></i>&nbsp;
                <ul>
                    
                </ul>
            </span>
        

        
        
            <span class="meta-info-item article-wordcount">
                <i class="icon fas fa-file-word"></i>&nbsp;<span>3.2k 字</span>
            </span>
        
        
            <span class="meta-info-item article-min2read">
                <i class="icon fas fa-clock"></i>&nbsp;<span>12 分钟</span>
            </span>
        
        
            <span class="meta-info-item article-pv">
                <i class="icon fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
            </span>
        
    </div>

    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content keep-markdown-body">
                

                <h1 id="第一章：关于对象"><a href="#第一章：关于对象" class="headerlink" title="第一章：关于对象"></a>第一章：关于对象</h1><p>在C语言中，“数据” 和“处理数据的操作 (函数)” 是分开来声明的，也就是说，语言本身并没有支持“数据和函数” 之间的关联性。我们把这种程序方法称为程序性的(procedural)，由一组 “分布在各个以功能为导向的函数中” 的算 法所驱动，它们处理的是共同的外部数据。举个例子，如果我们声明一个<code>struct Point3d</code>，像这样：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">point3d</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="type">float</span> x;</span><br><span class="line">  <span class="type">float</span> y;</span><br><span class="line">  <span class="type">float</span> z;</span><br><span class="line">&#125; Point3d;</span><br></pre></td></tr></table></figure>

<p>但当我们想打印<code>Point3d</code>这个数据结构时，我们就得定义一个像这样的函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">Point3d_print</span><span class="params">(<span class="type">const</span> Point3d *pd)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;(%g, %g, %g)&quot;</span>, pd-&gt;x, pd-&gt;y, pd-&gt;z);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>或者定义一个宏，抑或是直接在函数中完成打印操作，也可以经由一个前置处理宏来完成。</p>
</blockquote>
<p>而在C++中，*<code>Point3d</code>* 有可能采用独立的“抽象数据类型(abstract data type, ADT)” 来实现：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Point3d</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">Point3d</span>(<span class="type">float</span> x = <span class="number">0.0</span>, <span class="type">float</span> y = <span class="number">0.0</span>, <span class="type">float</span> z = <span class="number">0.0</span>) : _x(x), _y(y), _z(z) &#123;&#125;</span><br><span class="line">  <span class="function"><span class="type">float</span> <span class="title">x</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> _x; &#125;</span><br><span class="line">  <span class="function"><span class="type">float</span> <span class="title">y</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> _y; &#125;</span><br><span class="line">  <span class="function"><span class="type">float</span> <span class="title">z</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> _z; &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">x</span><span class="params">(<span class="type">float</span> xval)</span> </span>&#123; _x = xval; &#125;</span><br><span class="line">  <span class="comment">// ... etc ...</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">  <span class="type">float</span> _x;</span><br><span class="line">  <span class="type">float</span> _y;</span><br><span class="line">  <span class="type">float</span> _z;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> ostream&amp;</span><br><span class="line"><span class="keyword">operator</span>&lt;&lt; (ostream &amp;os, <span class="type">const</span> Point3d &amp;pt)</span><br><span class="line">&#123;</span><br><span class="line">  os &lt;&lt; <span class="string">&quot;(&quot;</span> &lt;&lt; pt.<span class="built_in">x</span>() &lt;&lt; <span class="string">&quot;,&quot;</span></span><br><span class="line">     &lt;&lt; pt.<span class="built_in">y</span>() &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; pt.<span class="built_in">z</span>() &lt;&lt; <span class="string">&quot;)&quot;</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>很明显，C和C++不只在程序风格上有显著的不同，在程序的思考上也有明显的差异。</p>
<h2 id="加上封装后的布局成本"><a href="#加上封装后的布局成本" class="headerlink" title="加上封装后的布局成本"></a>加上封装后的布局成本</h2><p>当我们将<code>Point3d</code>转换到C++之后，第一个可能想到的问题就是:<strong>加上了封裝之后，程序的布局成本是否增加了?</strong> 答案是<code>class Point3d</code> 并<strong>没有增加成本</strong>。这是因为：</p>
<ul>
<li>三个 data merabers 直接内含在每一个class object 之中，就像C struct 的情况一样。</li>
<li>而member functions虽然含在class的声明之内，却不出现在object 之中。</li>
<li>每一个non-inline member function 只会诞生一个函数实例。至于每一个“拥有零个或一个定义” 的inline function 则会在其每一个使用者 (模块) 身上产生一个函数实例。</li>
</ul>
<p><strong><code>Point3d</code>支持封装这一点并未带给它任何额外的成本。</strong>而且C++在布局以及存取时间上主要的额外负担是由virtual 引起的：</p>
<ul>
<li>virtual function 机制：保存vtable和通过vtable找到函数地址。</li>
<li>virtual base class 机制：通过指针来找到基类的成员。</li>
</ul>
<h2 id="1-1-C-对象模型"><a href="#1-1-C-对象模型" class="headerlink" title="1.1 C++对象模型"></a>1.1 C++对象模型</h2><p>在C++中有：</p>
<ul>
<li><strong>两种类数据成员：static 和 nonstatic</strong></li>
<li><strong>三种类成员函数：static 、nonstatic 和 virtual</strong>。</li>
</ul>
<p>下面我们通过class <code>Point</code>来看一下，在机器中类是如何模塑 (modeling) 出各种data members 和function members 的。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Point</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">Point</span>(<span class="type">float</span> xval);</span><br><span class="line">  <span class="keyword">virtual</span> ~<span class="built_in">Point</span>();</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="type">float</span> <span class="title">x</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line">  <span class="function"><span class="type">static</span> <span class="type">int</span> <span class="title">PointCount</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> ostream&amp; <span class="title">print</span><span class="params">(ostream &amp;os)</span> <span class="type">const</span></span>;</span><br><span class="line">  </span><br><span class="line">  <span class="type">float</span> _x;</span><br><span class="line">  <span class="type">static</span> <span class="type">int</span> _point_count;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="1-1-1-简单对象模型"><a href="#1-1-1-简单对象模型" class="headerlink" title="1.1.1 简单对象模型"></a>1.1.1 简单对象模型</h3><p>在简单模型中，一个对象由一系列的 slots 构成，每一个 slot 指向一个 members。Members 按其声明顺序，各被指定一个 slot。每一个 data member 或 function member 都有自己的一个slot。</p>
<img  
                     lazyload
                     alt="image"
                     data-src="./img/SimpleObjectModel.png"
                      alt="SimpleObjectModel" style="zoom:50%;" 
                >

<p>在这个简单模型下，members 本身并不放在对象内，只有“指向member 的指针” 才放在对象内（避免了“members 有<strong>不同的类型，因而需要不同的存储空间</strong>” 的问题）。对象中的 members 是通过 slot 的索引值来寻址的，本例之中_x的索引是6，_point_counrt 的索引是7。</p>
<p>需要注意这个模型并没有被应用于实际产品上，不过关于<strong>索引或 slot 个数的观念，</strong> 倒是被应用到C++的“指向成员的指针” (pointer-to-member)观念之中。</p>
<h3 id="1-1-2-表格驱动对象模型"><a href="#1-1-2-表格驱动对象模型" class="headerlink" title="1.1.2 表格驱动对象模型"></a>1.1.2 表格驱动对象模型</h3><p>如果对所有类中所有对象都有一致的表达方式的话，就可以采用下面的模型。该对象模型把所有与members 相关的信息抽出来，放在一个 <strong>data member table</strong> 和一个 <strong>member functiontable</strong> 之中，class object 本身则内含指向这两个表格的指针。Member function table 是一系列的 slots，每一个slot 指向一个member function；Data member table 则直接持有 data 本身。(<strong>没有实际应用于真正的 C++ 编译器身上</strong>，但 member function table 这个观念却成为支持virtual functions的一个有效方案)</p>
<img  
                     lazyload
                     alt="image"
                     data-src="./img/MemberTableModel.png"
                      style="zoom:50%;" 
                >

<h3 id="1-1-3-C-对象模型"><a href="#1-1-3-C-对象模型" class="headerlink" title="1.1.3 C++对象模型"></a>1.1.3 C++对象模型</h3><p>前两个模型有两个主要问题：引入的指针过多，空间浪费严重；另一个则是添加的索引层次过多，导致数据存取性能较低。C++对象模型是从简单对象模型派生而来，并对内存空间和存取时间做了优化。在此模型下：</p>
<ul>
<li>Nonstatic data members 放在每一个类对象之内；</li>
<li>static data members 存放在类对象之外；</li>
<li>Static和nonstatic function members 也被放在类对象之外。</li>
</ul>
<img  
                     lazyload
                     alt="image"
                     data-src="/Users/gygao/Notes/深入理解对象模型/img/C++ObjectModel.png"
                      style="zoom:50%;" 
                >

<ul>
<li>虚函数机制则由以下的 2 个的两个步骤来支持:<ul>
<li>每一个class会产生一个虚表(vtbl, vtable)，虚表中存放着一系列指向虚函数的指针;</li>
<li>每一个class 对象内添加一个指针vptr，指向相对应的vtable。vptr的设定与重置由每一个class的构造函数、析构函数和拷贝赋值运算符自动完成。</li>
<li>通常每一个 class 所关联的 <strong>type_info</strong> 对象的指针保存在<strong>vtable</strong> 的第一个 <strong>slot</strong> 中，用于支持RTTI (runtime type identification)</li>
</ul>
</li>
<li>需要清楚的明白一点是: <strong>一个 vtable 对应一个 class，一个 vptr 才对应一个 class object</strong>，必须区分开这 2 个概念。</li>
</ul>
<h2 id="1-2-关键词所带来的差异"><a href="#1-2-关键词所带来的差异" class="headerlink" title="1.2 关键词所带来的差异"></a>1.2 关键词所带来的差异</h2><ul>
<li><p>C++优先判断一个语句为声明: 当语言无法区分一个语句是声明还是表达式时，就需用用一个超越语言范围的规则。</p>
</li>
<li><p>struct 和 class 关键字的意义:</p>
<ul>
<li><p>它们之间在语言层面并无本质的区别，更多的是概念和编程思想上的区别。</p>
</li>
<li><p>struct 用来表现那些只有数据的集合体 POD(Plain OI’ Data)、而 class 则希望表达的</p>
<p>是 ADT(abstract data type)的思想;</p>
</li>
<li><p>由于这2个关键字在本质是无区别，所以class并没有必须要引入，但是引入它的确非常令人满意，因为这个语言所引入的不止是这个关键字，还有它所支持的封装和继承的哲学;</p>
</li>
<li><p>由于这2个关键字在本质是无区别，所以class并没有必须要引入，但是引入它的确非常令人满意，因为这个语言所引入的不止是这个关键字，还有它所支持的封装和继承的哲学;</p>
</li>
</ul>
</li>
<li><p>C++只保证处于同一个 access section 的数据，一定会以声明的次序出现在内存布局当中。 C++标准只提供了这一点点的保证。</p>
</li>
<li><p>与 C 兼容的内存布局: 组合，而非继承，才是把 C 和 C++结合在一起的唯一可行的方法。 只有使用组合时，才能够保证与 C 拥有相同的内存布局，使用继承时的内存布局是不受 C++ Standard 所保证的(很多编译器也可行，但是标准未定义!)。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">C_point</span> &#123;...&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Point</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">operator</span> <span class="title">C_point</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> _c_point; &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">  C_point _c_point;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="1-3-对象的差异"><a href="#1-3-对象的差异" class="headerlink" title="1.3 对象的差异"></a>1.3 对象的差异</h2><p>C++程序设计模型直接支持三种programming paradigms。</p>
<ul>
<li>程序模型 (procedural model): 就像C一样，一条语句接一条语句的执行或者函数跳转;</li>
<li>抽象数据类型模型 (abstract data type model, ADT): 此模型所谓的“抽象”是和一组表达式(public 接口) 一起提供的，那时其运算定义仍然隐而未明;</li>
<li>面向对象模型 (object-oriented model): 在此模型中有一些彼此相关的类型，通过一个抽象的base class (用以提供共同接口)被封装起来 。C++ 通过class 的pointers和references来支持多态，这种程序设计风格就称为“面向对象” 。</li>
</ul>
<blockquote>
<p>虽然你可以直接或间接处理继承体系中的一个base class object，<strong>但只有通过 pointer 或reference 的间接处理，才支持OO程序设计所需的多态性质</strong>。</p>
</blockquote>
<p>在C++，多态只存在于一个个的public class 体系中。举个例子，px可能指向某个类型的object，或指向根据public 继承关系派生而来的一个子类型。Nonpublic 的派生行为以及类型为void*的指针可以说是多态的，但它们并没有被语言明确地支持，也就是说它们必须由程序员通过显式的转换操作来管理。</p>
<p>C++以下列方式支持多态</p>
<ul>
<li><p>经由一组隐式的转化操作。例如把一个derived class指针转化为一个指向其public base type的指针：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shape *ps = <span class="keyword">new</span> <span class="built_in">circle</span>();</span><br></pre></td></tr></table></figure>
</li>
<li><p>经由virtual function 机制：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps-&gt;<span class="built_in">rotate</span>();</span><br></pre></td></tr></table></figure>
</li>
<li><p>经由dynamic_cast和typeid运算符：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (circle *pc = <span class="built_in">dynamic_cast</span>&lt;circle*&gt;(ps)) ...</span><br></pre></td></tr></table></figure></li>
</ul>
<p>多态的主要用途是经由一个共同的接又来影响类型的封装，这个接又通常被定义在一个抽象的base class 中。例如Library_materials class就为Book、ridea、 Pupper 等 subtype 定义了一个接口。这个共享接口是以virtual function 机制引发的， 它可以在执行期根据object 的真正类型解析出到底是哪一个西数实例被调用。</p>
<p>需要多少内存才能够表现一个claso bject ?一般而言要有:</p>
<ul>
<li>其nonstatic data members 的总和大小；</li>
<li>加上任何由于位对齐 (alignment) 的需求而填补(padding) 上去的空间(可能存在于 members 之间，也可能存在于集合体边界)；</li>
<li>加上为了支持 virtual 机制而由内部产生的任何额外负担(overhead)。</li>
</ul>
<blockquote>
<p>一个指针 (或是一个reference)。本质上，一个reference通常是以一个指针来实现的，而object 语法如果转换为间接手法，就需要一个指针)，不管它指向哪一种数据类型，<strong>指针本身所需的内存大小是固定的</strong>。</p>
</blockquote>
<h3 id="1-3-1-指针的类型"><a href="#1-3-1-指针的类型" class="headerlink" title="1.3.1 指针的类型"></a>1.3.1 指针的类型</h3><p>一个指向ZooAnimal 的指针是如何地与一个指向整数的指针或一个指向template Array 的指针有所不同呢 ?</p>
<p>以内存需求的观点来说，没有什么不同！它们三个都需要有足够的内存来放置一个机器地址。“指向不同类型之各指针” 间的差异， 既不在其指针表示法不同 ，也不在其内容 (代表一个地址)不同，而是在其所寻址出来的 object 类型不同。也就是说，“指针类型”会教导编译器如何解释某个特定地址中的内存内容及其大小:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ZooAnimal</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">ZooAnimal</span>();</span><br><span class="line">  <span class="keyword">virtual</span> ~<span class="built_in">ZooAnimal</span>();</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">rotate</span><span class="params">()</span></span>;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">  <span class="type">int</span> loc;</span><br><span class="line">  String name;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>一个指向地址 1000 的整数指针，在 32 位机器上，将涌盖地址空间1000~1003 (32位机器上的整数是4-bytes)。</li>
<li>如 果 String 是传统的 8-bytes (包括一个4-bytes 的字符指针和一个用来表示字符串长度的整数)，那么一个 ZooAnimal 指针将横跨地址空间1000~1015。</li>
</ul>
<p>那么，一个指向地址1000 而类型为<code>void*</code>的指针，将涵盖怎样的地址空间呢? 是的，我们不知道!这就是为什么一个类型为<code>void*</code>的指针只能够持有一个地址，而不能够通过它操作所指的object的缘故。<br>所以，转换 ( cast )其实是一种编译器指令。<strong>大部分情况下它并不改变一个指针所含的真正地址，它只影响 “被指出之内存的大小和其内容” 的解释方式</strong>。</p>
<h3 id="1-3-2-加上多态以后"><a href="#1-3-2-加上多态以后" class="headerlink" title="1.3.2 加上多态以后"></a>1.3.2 加上多态以后</h3><p>现在考虑一个Bear类，作为一种ZooAnimal：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Bear</span> : <span class="keyword">public</span> ZooAnimal</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">Bear</span>();</span><br><span class="line">  ~<span class="built_in">Bear</span>();</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">dance</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">  <span class="keyword">enum</span> <span class="title class_">Dances</span> &#123; ... &#125;;</span><br><span class="line">  </span><br><span class="line">  Dances dances_known;</span><br><span class="line">  <span class="type">int</span> cell_block;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">Bear <span class="title">b</span><span class="params">(<span class="string">&quot;Yogi&quot;</span>)</span></span>;</span><br><span class="line">Bear *pb = &amp;b;</span><br><span class="line">Bear &amp;rb = *pb;</span><br></pre></td></tr></table></figure>

<p><code>b,pb,rb</code>会有怎样的内存需求？ 不管是<code>pointer</code>或<code>reference</code>都只需要一个word的空间。Bear object需要24bytes, 也就是 ZooAnimal 的16bytes加上Bear所带来的8bytes。其可能的内存布局如下：</p>
<img  
                     lazyload
                     alt="image"
                     data-src="/Users/gygao/Notes/深入理解对象模型/img/DerivedLayout.png"
                      style="zoom:50%;" 
                >



<p>多态只能由”指针“或”引用“来实现，根本原因在于:</p>
<ul>
<li>指针和引用(通常以指针来实现)的大小是固定的(一个word)，而对象的大小却是可变的。其类的指针和引用可以指向(或引用)子类，但是基类的对象永远也只能是基类，没有变化则不可能引发多态。</li>
<li>一个point或reference绝不会引发任何”与类型有关的内存委托操作“，在指针类型转换时会受到的改变的只有它们所指向的内存的大小和解释方式而已。</li>
</ul>

            </div>

            
                <div class="post-copyright-info">
                    
<div class="article-copyright-info-container">
    <ul class="copyright-info-content">
        <li class="post-title">
            <span class="type">本文标题</span>：<span class="content">深入理解C++对象模型(一)</span>
        </li>
        <li class="post-author">
            <span class="type">本文作者</span>：<span class="content">hahahanba</span>
        </li>
        <li class="post-time">
            <span class="type">创建时间</span>：<span class="content">2024-04-18 10:25:22</span>
        </li>
        <li class="post-link">
            <span class="type">本文链接</span>：<span class="content">2024/04/18/深入理解C-对象模型/</span>
        </li>
        <li class="post-license">
            <span class="type">版权声明</span>：<span class="content">本博客所有文章除特别声明外，均采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> 许可协议。转载请注明出处！</span>
        </li>
    </ul>
    <div class="copy-copyright-info flex-center tooltip" data-content="复制版权信息" data-offset-y="-2px">
        <i class="fa-solid fa-copy"></i>
    </div>
</div>

                </div>
            

            

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                               rel="prev"
                               href="/2024/04/18/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3C-%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B-%E4%BA%8C/"
                            >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                                <span class="title flex-center">
                                <span class="post-nav-title-item text-ellipsis">深入理解C++对象模型(二)</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                               rel="next"
                               href="/2023/10/10/%E9%9D%99%E6%80%81%E9%93%BE%E6%8E%A5/"
                            >
                            <span class="title flex-center">
                                <span class="post-nav-title-item text-ellipsis">静态链接</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                                <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                            </a>
                        </div>
                    
                </div>
            

            
                


    <div class="comments-container">
        <div id="comments-anchor"></div>
        <div class="comment-area-title">
            <i class="fas fa-comments"></i>&nbsp;评论
        </div>
        
            

    <div class="giscus-comments-container">
        <div class="giscus" id="giscus"></div>
        <script >

          if (!window?.__getGiscusTheme) {
            window.__getGiscusTheme = () => {
              return document.body.classList.contains("dark-mode") ? "dark_dimmed" : "light_tritanopia";
            };
          }

          if (!window?.__changeGiscusTheme) {
            window.__changeGiscusTheme = () => {
              const iframe = document.querySelector("iframe.giscus-frame");
              iframe && iframe.contentWindow.postMessage({
                giscus: {
                  setConfig: {
                    theme: __getGiscusTheme()
                  }
                }
              }, "https://giscus.app");
            };
          }

          if (!window?.__loadGiscus) {
            window.__loadGiscus = () => {
              const script = document.createElement("script");
              script.async = true;
              script.src = "https://giscus.app/client.js";
              script.setAttribute("data-repo", 'hahahanba/comments');
              script.setAttribute("data-repo-id", 'R_kgDOKGpC9g');
              script.setAttribute("data-category", 'Announcements');
              script.setAttribute("data-category-id", 'DIC_kwDOKGpC9s4CYk-p');
              script.setAttribute("data-reactions-enabled", '1');
              script.setAttribute("data-lang", 'zh-CN');
              script.setAttribute("data-mapping", "pathname");
              script.setAttribute("data-strict", "0");
              script.setAttribute("data-emit-metadata", "0");
              script.setAttribute("data-input-position", "top");
              script.setAttribute("crossorigin", "anonymous");
              script.setAttribute("loading", "lazy");
              script.setAttribute("data-theme", __getGiscusTheme());
              document.querySelector(".giscus-comments-container").appendChild(script);

              const toggleThemeBtn = document.querySelector(".tool-dark-light-toggle");
              toggleThemeBtn && toggleThemeBtn.addEventListener("click", () => {
                __changeGiscusTheme();
              });
            }
          }

          if ('false' === "true") {
            setTimeout(() => {
              __loadGiscus();
            }, 1000);
          } else {
            window.addEventListener("DOMContentLoaded", () => {
              setTimeout(() => {
                __loadGiscus();
              }, 1000);
            });
          }
        </script>
    </div>


        
    </div>





            
        </div>

        
            <div class="pc-post-toc left-toc">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0%EF%BC%9A%E5%85%B3%E4%BA%8E%E5%AF%B9%E8%B1%A1"><span class="nav-number">1.</span> <span class="nav-text">第一章：关于对象</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%A0%E4%B8%8A%E5%B0%81%E8%A3%85%E5%90%8E%E7%9A%84%E5%B8%83%E5%B1%80%E6%88%90%E6%9C%AC"><span class="nav-number">1.1.</span> <span class="nav-text">加上封装后的布局成本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-C-%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.2.</span> <span class="nav-text">1.1 C++对象模型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-1-%E7%AE%80%E5%8D%95%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.2.1.</span> <span class="nav-text">1.1.1 简单对象模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-2-%E8%A1%A8%E6%A0%BC%E9%A9%B1%E5%8A%A8%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.2.2.</span> <span class="nav-text">1.1.2 表格驱动对象模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-3-C-%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.2.3.</span> <span class="nav-text">1.1.3 C++对象模型</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-%E5%85%B3%E9%94%AE%E8%AF%8D%E6%89%80%E5%B8%A6%E6%9D%A5%E7%9A%84%E5%B7%AE%E5%BC%82"><span class="nav-number">1.3.</span> <span class="nav-text">1.2 关键词所带来的差异</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%B7%AE%E5%BC%82"><span class="nav-number">1.4.</span> <span class="nav-text">1.3 对象的差异</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-1-%E6%8C%87%E9%92%88%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.4.1.</span> <span class="nav-text">1.3.1 指针的类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-2-%E5%8A%A0%E4%B8%8A%E5%A4%9A%E6%80%81%E4%BB%A5%E5%90%8E"><span class="nav-number">1.4.2.</span> <span class="nav-text">1.3.2 加上多态以后</span></a></li></ol></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom border-box">
            
<footer class="footer border-box">
    <div class="border-box website-info-box default">
        
            <div class="copyright-info info-item default">
                &copy;&nbsp;<span>2023</span>&nbsp;-&nbsp;2024
                
                    &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href="/">hahahanba</a>
                
            </div>

            <div class="theme-info info-item default">
                由&nbsp;<a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.7.3</a>
            </div>

            

            
        

        <div class="count-item info-item default">
            
                <span class="count-box border-box word">
                    <span class="item-type border-box">全站总字数</span>
                    <span class="item-value border-box word">18.9k</span>
                </span>
            

            
                <span class="count-box border-box uv">
                    <span class="item-type border-box">访问人数</span>
                    <span class="item-value border-box uv" id="busuanzi_value_site_uv"></span>
                </span>
            

            
                <span class="count-box border-box pv">
                    <span class="item-type border-box">总访问量</span>
                    <span class="item-value border-box pv" id="busuanzi_value_site_pv"></span>
                </span>
            
        </div>
    </div>
</footer>

        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools left-toc">
            <div class="post-tools-container border-box">
    <ul class="tools-list border-box">
        <!-- PC TOC show toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- PC go comment -->
        
            <li class="tools-item flex-center go-to-comments">
                <i class="fas fa-comment"></i>
                <span class="post-comments-count"></span>
            </li>
        
    </ul>
</div>

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="fas fa-arrow-up"></i>
            </li>
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        
            <li class="tools-item toggle-show-toc-tablet flex-center">
                <i class="fas fa-list"></i>
            </li>
        

        
            <li class="tools-item go-to-comments-tablet flex-center">
                <i class="fas fa-comment"></i>
            </li>
        

        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>

        
    </ul>
</div>

    </div>

    <!-- image mask -->
    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    <!-- local search -->
    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

    <!-- tablet toc -->
    
        <div class="tablet-post-toc-mask">
            <div class="tablet-post-toc">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0%EF%BC%9A%E5%85%B3%E4%BA%8E%E5%AF%B9%E8%B1%A1"><span class="nav-number">1.</span> <span class="nav-text">第一章：关于对象</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%A0%E4%B8%8A%E5%B0%81%E8%A3%85%E5%90%8E%E7%9A%84%E5%B8%83%E5%B1%80%E6%88%90%E6%9C%AC"><span class="nav-number">1.1.</span> <span class="nav-text">加上封装后的布局成本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-C-%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.2.</span> <span class="nav-text">1.1 C++对象模型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-1-%E7%AE%80%E5%8D%95%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.2.1.</span> <span class="nav-text">1.1.1 简单对象模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-2-%E8%A1%A8%E6%A0%BC%E9%A9%B1%E5%8A%A8%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.2.2.</span> <span class="nav-text">1.1.2 表格驱动对象模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-3-C-%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.2.3.</span> <span class="nav-text">1.1.3 C++对象模型</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-%E5%85%B3%E9%94%AE%E8%AF%8D%E6%89%80%E5%B8%A6%E6%9D%A5%E7%9A%84%E5%B7%AE%E5%BC%82"><span class="nav-number">1.3.</span> <span class="nav-text">1.2 关键词所带来的差异</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%B7%AE%E5%BC%82"><span class="nav-number">1.4.</span> <span class="nav-text">1.3 对象的差异</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-1-%E6%8C%87%E9%92%88%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.4.1.</span> <span class="nav-text">1.3.1 指针的类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-2-%E5%8A%A0%E4%B8%8A%E5%A4%9A%E6%80%81%E4%BB%A5%E5%90%8E"><span class="nav-number">1.4.2.</span> <span class="nav-text">1.3.2 加上多态以后</span></a></li></ol></li></ol></li></ol>
    </div>
</div>

            </div>
        </div>
    
</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.7.3/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.7.3/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.7.3/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.7.3/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.7.3/source/js/dark-light-toggle.js"></script>




    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.7.3/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.7.3/source/js/code-block.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.7.3/source/js/lazyload.js"></script>


<div class="post-scripts">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.7.3/source/js/post-helper.js"></script>
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.7.3/source/js/libs/anime.min.js"></script>
        
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.7.3/source/js/toc.js"></script>
        
    
    
    
</div>




</body>
</html>
